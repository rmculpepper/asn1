<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>4&nbsp;Translating Existing ASN.1 Definitions</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">ASN.1</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="intro.html" class="tocviewlink" data-pltdoc="x">Introduction to the ASN.1 Library</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="types.html" class="tocviewlink" data-pltdoc="x">ASN.1 Types</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="der.html" class="tocviewlink" data-pltdoc="x">DER Encoding and Decoding</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Translating Existing ASN.1 Definitions</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="util.html" class="tocviewlink" data-pltdoc="x">ASN.1-<wbr></wbr>Related Utilities</a></td></tr><tr><td align="right"></td><td><a href="doc-bibliography.html" class="tocviewlink" data-pltdoc="x">Bibliography</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>4&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Translating Existing ASN.1 Definitions</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">4.1&nbsp;</td><td><a href="#%28part._handling-defs%29" class="tocviewlink" data-pltdoc="x">Translating ASN.1 Definition Order</a></td></tr><tr><td align="right">4.2&nbsp;</td><td><a href="#%28part._handling-info%29" class="tocviewlink" data-pltdoc="x">Translating Information Classes, Objects, and Object Sets</a></td></tr><tr><td align="right">4.3&nbsp;</td><td><a href="#%28part._handling-unsupported%29" class="tocviewlink" data-pltdoc="x">Handling Unsupported Types</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">4.1<tt>&nbsp;</tt></span><a href="#%28part._handling-defs%29" class="tocsubseclink" data-pltdoc="x">Translating ASN.1 Definition Order</a></td></tr><tr><td><span class="tocsublinknumber">4.2<tt>&nbsp;</tt></span><a href="#%28part._handling-info%29" class="tocsubseclink" data-pltdoc="x">Translating Information Classes, Objects, and Object Sets</a></td></tr><tr><td><span class="tocsublinknumber">4.3<tt>&nbsp;</tt></span><a href="#%28part._handling-unsupported%29" class="tocsubseclink" data-pltdoc="x">Handling Unsupported Types</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft">&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="der.html" title="backward to &quot;3 DER Encoding and Decoding&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;ASN.1&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="util.html" title="forward to &quot;5 ASN.1-Related Utilities&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>4<tt>&nbsp;</tt><a name="(part._translating)"></a>Translating Existing ASN.1 Definitions</h3><p>This section gives general advice on translating existing ASN.1
modules.</p><p><div class="SIntrapara">For additional illustration, the <span class="stt">examples</span> directory contains
examples of a few ASN.1 modules from internet standards translated to
use this library. Use
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/collects.html#%28def._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._collection-path%29%29" class="RktValLink" data-pltdoc="x">collection-path</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"asn1"</span><span class="hspace">&nbsp;</span><span class="RktVal">"examples"</span><span class="RktPn">)</span></p></blockquote></div><div class="SIntrapara">to locate the local directory containing the examples, or
<a href="https://github.com/rmculpepper/asn1/tree/master/asn1-lib/asn1/examples/">view
them online</a>.</div></p><h4>4.1<tt>&nbsp;</tt><a name="(part._handling-defs)"></a>Translating ASN.1 Definition Order</h4><p>In ASN.1 modules, definition order doesn&rsquo;t matter, and ASN.1 code
often takes advantage of this by ordering definitions top-down. When
the ASN.1 module is translated to Racket, the definitions must be
reordered.</p><p>For complex modules, it can be difficult to find a legal ordering that
also preserves relatedness. In such cases, it may be better to split
the module into three coarse sections, consisting of object identifier
definitions, type definitions, and information object set definitions.</p><p>Object identifier definitions should come first, because they never
depend on types or information object sets, and they are easy to
locally reorder. Use <span class="RktSym"><a href="types.html#%28form._%28%28lib._asn1%2Fmain..rkt%29._.O.I.D%29%29" class="RktStxLink" data-pltdoc="x">OID</a></span> and <span class="RktSym"><a href="types.html#%28form._%28%28lib._asn1%2Fmain..rkt%29._build-.O.I.D%29%29" class="RktStxLink" data-pltdoc="x">build-OID</a></span> to preserve
the mnemonic names associated with arc numbers.</p><p>Type definitions should come next. Type definitions can be made
independent of ordering by defining them using
<span class="RktSym"><a href="types.html#%28form._%28%28lib._asn1%2Fmain..rkt%29._define-asn1-type%29%29" class="RktStxLink" data-pltdoc="x">define-asn1-type</a></span>, which is a simple abbreviation for
<span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span> with <span class="RktSym"><a href="types.html#%28form._%28%28lib._asn1%2Fmain..rkt%29._.Delay%29%29" class="RktStxLink" data-pltdoc="x">Delay</a></span>. Alternatively, type definitions
can be locally reordered bottom-up. Associated value definitions, such
as named integers, can be left close to their associated types, or
they can be moved to a different section.</p><p>Information object set definitions should come last, because they
typically refer to both object identifiers and types. Occasionally
they must be reordered within their section, for example when an
information object set aggregates other sets.</p><h4>4.2<tt>&nbsp;</tt><a name="(part._handling-info)"></a>Translating Information Classes, Objects, and Object Sets</h4><p>This library does not directly support ASN.1 information classes,
objects, and object sets. In general, however, only information object
sets need to be represented, and they can be represented as functions,
dictionaries, or association lists.</p><p>Consider the following ASN.1 code from [<a href="doc-bibliography.html#%28cite._.P.K.C.S1%29" data-pltdoc="x">PKCS1</a>]:</p><p><table cellspacing="0"><tr><td><p><span class="stt">ALGORITHM-IDENTIFIER ::= CLASS {</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&amp;id</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">OBJECT IDENTIFIER</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">UNIQUE,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">&amp;Type</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">OPTIONAL</span></p></td></tr><tr><td><p><span class="stt">} WITH SYNTAX { OID &amp;id [PARAMETERS &amp;Type] }</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">-- Allowed EME-OAEP and EMSA-PSS digest algorithms.</span></p></td></tr><tr><td><p><span class="stt">OAEP-PSSDigestAlgorithms ALGORITHM-IDENTIFIER ::= {</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">{ OID id-sha1 PARAMETERS NULL</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">}|</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">{ OID id-sha256 PARAMETERS NULL }|</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">{ OID id-sha384 PARAMETERS NULL }|</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">{ OID id-sha512 PARAMETERS NULL },</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">...</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">-- Allows for future expansion -- }</span></p></td></tr></table></p><p>The definition for <span class="stt">ALGORITHM-IDENTIFIER</span> indicates that the class
serves as a mapping from <span class="stt">OBJECT IDENTIFIER</span>s to types. The
following information object set can be represented as an association
list as follows:</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">OAEP-PSSDigestAlgorithms</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">id-sha1</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="types.html#%28def._%28%28lib._asn1%2Fmain..rkt%29._.N.U.L.L%29%29" class="RktValLink" data-pltdoc="x">NULL</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">id-sha256</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="types.html#%28def._%28%28lib._asn1%2Fmain..rkt%29._.N.U.L.L%29%29" class="RktValLink" data-pltdoc="x">NULL</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">id-sha384</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="types.html#%28def._%28%28lib._asn1%2Fmain..rkt%29._.N.U.L.L%29%29" class="RktValLink" data-pltdoc="x">NULL</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">id-sha512</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="types.html#%28def._%28%28lib._asn1%2Fmain..rkt%29._.N.U.L.L%29%29" class="RktValLink" data-pltdoc="x">NULL</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>The following ASN.1 code defines a type parameterized by an
<span class="stt">ALGORITHM IDENTIFIER</span> information object set, and then
instantiates the type at the set defined above:</p><p><table cellspacing="0"><tr><td><p><span class="stt">AlgorithmIdentifier { ALGORITHM-IDENTIFIER:InfoObjectSet } ::= SEQUENCE {</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">algorithm</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">ALGORITHM-IDENTIFIER.&amp;id({InfoObjectSet}),</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">parameters ALGORITHM-IDENTIFIER.&amp;Type({InfoObjectSet}{@.algorithm})</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">OPTIONAL }</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">HashAlgorithm ::= AlgorithmIdentifier { {OAEP-PSSDigestAlgorithms} }</span></p></td></tr></table></p><p>Type parameterization can be represented as a Racket function, and
instantiation as application. The type lookup can be accomplished by a
dependent sequence field type.</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">AlgorithmIdentifier</span><span class="hspace">&nbsp;</span><span class="RktSym">InfoObjectSet</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="types.html#%28form._%28%28lib._asn1%2Fmain..rkt%29._.Sequence%29%29" class="RktStxLink" data-pltdoc="x">Sequence</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">algorithm</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="types.html#%28def._%28%28lib._asn1%2Fmain..rkt%29._.O.B.J.E.C.T-.I.D.E.N.T.I.F.I.E.R%29%29" class="RktValLink" data-pltdoc="x">OBJECT-IDENTIFIER</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">#:dependent</span><span class="hspace">&nbsp;</span><span class="RktSym">parameters</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._cadr%29%29" class="RktValLink" data-pltdoc="x">cadr</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._assoc%29%29" class="RktValLink" data-pltdoc="x">assoc</a></span><span class="hspace">&nbsp;</span><span class="RktSym">algorithm</span><span class="hspace">&nbsp;</span><span class="RktSym">InfoObjectSet</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">HashAlgorithm</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">AlgorithmIdentifier</span><span class="hspace">&nbsp;</span><span class="RktSym">OAEP-PSSDigestAlgorithms</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><h4>4.3<tt>&nbsp;</tt><a name="(part._handling-unsupported)"></a>Handling Unsupported Types</h4><p>ASN.1 defines many additional base types that are unsupported by this
library. An example is T61String, which has escape codes for changing
the interpretation of following characters. It is infeasible for this
library to handle the validation and interpretation of T61String, so
it does not define the type at all. However, an application may define
the type (or an approximation, if full validation and interpretation
are not needed) using <span class="RktSym"><a href="types.html#%28form._%28%28lib._asn1%2Fmain..rkt%29._.Tag%29%29" class="RktStxLink" data-pltdoc="x">Tag</a></span> with a universal implicit tag.</p><p>Here is a basic definition of <span class="RktSym">T61String</span> using <span class="RktSym"><a href="types.html#%28form._%28%28lib._asn1%2Fmain..rkt%29._.Tag%29%29" class="RktStxLink" data-pltdoc="x">Tag</a></span>:</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">T61String</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="types.html#%28form._%28%28lib._asn1%2Fmain..rkt%29._.Tag%29%29" class="RktStxLink" data-pltdoc="x">Tag</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:universal</span><span class="hspace">&nbsp;</span><span class="RktPn">#:implicit</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="types.html#%28def._%28%28lib._asn1%2Fmain..rkt%29._.O.C.T.E.T-.S.T.R.I.N.G%29%29" class="RktValLink" data-pltdoc="x">OCTET-STRING</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0"><tr><td></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="der.html#%28def._%28%28lib._asn1%2Fmain..rkt%29._.D.E.R-encode%29%29" class="RktValLink" data-pltdoc="x">DER-encode</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="types.html#%28def._%28%28lib._asn1%2Fmain..rkt%29._.O.C.T.E.T-.S.T.R.I.N.G%29%29" class="RktValLink" data-pltdoc="x">OCTET-STRING</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#"abc"</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">#"\4\3abc"</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="der.html#%28def._%28%28lib._asn1%2Fmain..rkt%29._.D.E.R-encode%29%29" class="RktValLink" data-pltdoc="x">DER-encode</a></span><span class="hspace">&nbsp;</span><span class="RktSym">T61String</span><span class="hspace">&nbsp;</span><span class="RktVal">#"abc"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">note different tag byte</span></td></tr><tr><td><p><span class="RktRes">#"\24\3abc"</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="der.html#%28def._%28%28lib._asn1%2Fmain..rkt%29._.D.E.R-decode%29%29" class="RktValLink" data-pltdoc="x">DER-decode</a></span><span class="hspace">&nbsp;</span><span class="RktSym">T61String</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="der.html#%28def._%28%28lib._asn1%2Fmain..rkt%29._.D.E.R-encode%29%29" class="RktValLink" data-pltdoc="x">DER-encode</a></span><span class="hspace">&nbsp;</span><span class="RktSym">T61String</span><span class="hspace">&nbsp;</span><span class="RktVal">#"abc"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">#"abc"</span></p></td></tr></table></blockquote><p>When encoding a <span class="RktSym">T61String</span>, the same Racket values are
accepted as for <span class="RktSym"><a href="types.html#%28def._%28%28lib._asn1%2Fmain..rkt%29._.O.C.T.E.T-.S.T.R.I.N.G%29%29" class="RktValLink" data-pltdoc="x">OCTET-STRING</a></span>&#8212;<wbr></wbr>that is, bytestrings
(<span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span>)&#8212;<wbr></wbr>and the same validation is performed&#8212;<wbr></wbr>that is,
none. Likewise when decoding.</p><p>To change the way T61Strings are encoded and decoded, use
<span class="RktSym"><a href="types.html#%28def._%28%28lib._asn1%2Fmain..rkt%29._.Wrap%29%29" class="RktValLink" data-pltdoc="x">Wrap</a></span> to add encoding and decoding rules (or see
<a href="der.html#%28part._der-hooks%29" data-pltdoc="x">DER Encoding and Decoding Hooks</a> for an alternative). Let us pretend for a moment
that T61Strings are just Latin-1 strings. Then we could define
T61String with automatic conversion to and from Racket strings as
follows:</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><table cellspacing="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">T61String</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="types.html#%28def._%28%28lib._asn1%2Fmain..rkt%29._.Wrap%29%29" class="RktValLink" data-pltdoc="x">Wrap</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="types.html#%28form._%28%28lib._asn1%2Fmain..rkt%29._.Tag%29%29" class="RktStxLink" data-pltdoc="x">Tag</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:universal</span><span class="hspace">&nbsp;</span><span class="RktPn">#:implicit</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="types.html#%28def._%28%28lib._asn1%2Fmain..rkt%29._.O.C.T.E.T-.S.T.R.I.N.G%29%29" class="RktValLink" data-pltdoc="x">OCTET-STRING</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:pre-encode</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._string-~3ebytes%2Flatin-1%29%29" class="RktValLink" data-pltdoc="x">string-&gt;bytes/latin-1</a></span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:post-decode</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes-~3estring%2Flatin-1%29%29" class="RktValLink" data-pltdoc="x">bytes-&gt;string/latin-1</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0"><tr><td></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="der.html#%28def._%28%28lib._asn1%2Fmain..rkt%29._.D.E.R-encode%29%29" class="RktValLink" data-pltdoc="x">DER-encode</a></span><span class="hspace">&nbsp;</span><span class="RktSym">T61String</span><span class="hspace">&nbsp;</span><span class="RktVal">"pretend T61 is Latin-1"</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">#"\24\26pretend T61 is Latin-1"</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="der.html#%28def._%28%28lib._asn1%2Fmain..rkt%29._.D.E.R-decode%29%29" class="RktValLink" data-pltdoc="x">DER-decode</a></span><span class="hspace">&nbsp;</span><span class="RktSym">T61String</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="der.html#%28def._%28%28lib._asn1%2Fmain..rkt%29._.D.E.R-encode%29%29" class="RktValLink" data-pltdoc="x">DER-encode</a></span><span class="hspace">&nbsp;</span><span class="RktSym">T61String</span><span class="hspace">&nbsp;</span><span class="RktVal">"pretend T61 is Latin-1"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">"pretend T61 is Latin-1"</span></p></td></tr></table></blockquote><p>The following ASN.1 pseudo-definitions may be helpful in translating
ASN.1 features not directly supported by this library. (Page numbers
refer to [<a href="doc-bibliography.html#%28cite._.Dubuisson2001%29" data-pltdoc="x">Dubuisson2001</a>].)</p><p><table cellspacing="0"><tr><td><p><span class="stt">-- pp141-145: REAL</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">REAL ::= [UNIVERSAL 9] IMPLICIT -- complicated --</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">-- p175: Additional string types</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">NumericString</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">::= [UNIVERSAL 18] IMPLICIT OCTET STRING</span></p></td></tr><tr><td><p><span class="stt">VisibleString</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">::= [UNIVERSAL 19] IMPLICIT OCTET STRING</span></p></td></tr><tr><td><p><span class="stt">ISO646String</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">::= VisibleString</span></p></td></tr><tr><td><p><span class="stt">TeletexString</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">::= [UNIVERSAL 20] IMPLICIT OCTET STRING</span></p></td></tr><tr><td><p><span class="stt">T61String</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">::= TeletexString</span></p></td></tr><tr><td><p><span class="stt">VideotexString</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">::= [UNIVERSAL 21] IMPLICIT OCTET STRING</span></p></td></tr><tr><td><p><span class="stt">GraphicString</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">::= [UNIVERSAL 25] IMPLICIT OCTET STRING</span></p></td></tr><tr><td><p><span class="stt">GeneralString</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">::= [UNIVERSAL 27] IMPLICIT ...</span></p></td></tr><tr><td><p><span class="stt">UniversalString ::= [UNIVERSAL 28] IMPLICIT OCTET STRING -- UCS-4</span></p></td></tr><tr><td><p><span class="stt">BMPString</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">::= [UNIVERSAL 30] IMPLICIT OCTET STRING -- UCS-2</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">-- pp198-199: Object descriptors</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">ObjectDescriptor ::= [UNIVERSAL 7] IMPLICIT GraphicString</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">-- pp199-204: Time types</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">GeneralizedTime ::= [UNIVERSAL 24] IMPLICIT OCTET STRING</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">-- YYYYMMDDhh[mm[ss[.f+]]]Z</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">UTCTime</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">::= [UNIVERSAL 23] IMPLICIT OCTET STRING</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">-- YYMMDDhhmm[ss]Z</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">-- Note 2-digit year!</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">-- p301: EXTERNAL</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">EXTERNAL ::= [UNIVERSAL 8] IMPLICIT SEQUENCE {</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">-- at least one of {direct-reference, indirect-reference} is required</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">direct-reference</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">OBJECT IDENTIFIER OPTIONAL,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">indirect-reference</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">INTEGER OPTIONAL,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">data-value-descriptor ObjectDescriptor OPTIONAL,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">encoding</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">CHOICE {</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">single-ASN1-type</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">[0] EXPLICIT ANY,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">octet-aligned</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">[1] IMPLICIT OCTET STRING,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">arbitrary</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">[2] IMPLICIT BIT STRING } }</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">-- This is the pre-1994 abstract syntax of EXTERNAL, but the encoding</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">-- is still based on this rather than the new abstract syntax.</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">-- pp358-361: TYPE-IDENTIFIER and INSTANCE OF</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">TYPE-IDENTIFIER ::= CLASS {</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&amp;id</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">OBJECT IDENTIFIER UNIQUE,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&amp;Type }</span></p></td></tr><tr><td><p><span class="stt">WITH SYNTAX {&amp;Type IDENTIFIED BY &amp;id}</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">INSTANCE OF ObjectClass.&amp;Type({ObjectSet}) ::=</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">[UNIVERSAL 8] IMPLICIT</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">SEQUENCE { type-id ObjectClass.&amp;id({ObjectSet}),</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">value [0] EXPLICIT ObjectClass.&amp;Type({ObjectSet})(@.type-id) }</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">-- Note: encoding coincides with EXTERNAL</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">-- pp361-364: ABSTRACT-SYNTAX</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">ABSTRACT-SYNTAX ::= CLASS {</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&amp;id</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">OBJECT IDENTIFIER,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&amp;Type,</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&amp;property BIT STRING { handles-invalid-encodings(0) }</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">DEFAULT {} }</span></p></td></tr><tr><td><p><span class="stt">WITH SYNTAX { &amp;Type IDENTIFIED BY &amp;id</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">[HAS PROPERTY &amp;property] }</span></p></td></tr></table></p><div class="navsetbottom"><span class="navleft">&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="der.html" title="backward to &quot;3 DER Encoding and Decoding&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;ASN.1&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="util.html" title="forward to &quot;5 ASN.1-Related Utilities&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>